                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.5.2 #9293 (MINGW32)
                              4 ; This file was generated Wed Oct 31 22:58:47 2018
                              5 ;--------------------------------------------------------
                              6 	.module tile_chac_chac
                              7 	.optsdcc -mz80
                              8 	
                              9 ;--------------------------------------------------------
                             10 ; Public variables in this module
                             11 ;--------------------------------------------------------
                             12 	.globl _map_set
                             13 	.globl _chac_chacs_add
                             14 	.globl _chac_chacs_do
                             15 ;--------------------------------------------------------
                             16 ; special function registers
                             17 ;--------------------------------------------------------
                             18 ;--------------------------------------------------------
                             19 ; ram data
                             20 ;--------------------------------------------------------
                             21 	.area _DATA
                             22 ;--------------------------------------------------------
                             23 ; ram data
                             24 ;--------------------------------------------------------
                             25 	.area _INITIALIZED
                             26 ;--------------------------------------------------------
                             27 ; absolute external ram data
                             28 ;--------------------------------------------------------
                             29 	.area _DABS (ABS)
                             30 ;--------------------------------------------------------
                             31 ; global & static initialisations
                             32 ;--------------------------------------------------------
                             33 	.area _HOME
                             34 	.area _GSINIT
                             35 	.area _GSFINAL
                             36 	.area _GSINIT
                             37 ;--------------------------------------------------------
                             38 ; Home
                             39 ;--------------------------------------------------------
                             40 	.area _HOME
                             41 	.area _HOME
                             42 ;--------------------------------------------------------
                             43 ; code
                             44 ;--------------------------------------------------------
                             45 	.area _CODE
                             46 ;engine/tile_chac_chac.c:18: void chac_chacs_add (void) {
                             47 ;	---------------------------------
                             48 ; Function chac_chacs_add
                             49 ; ---------------------------------
   0000                      50 _chac_chacs_add::
                             51 ;engine/tile_chac_chac.c:20: if (max_chac_chacs == MAX_CHAC_CHACS) return;
   0000 3Ar00r00      [13]   52 	ld	a,(#_max_chac_chacs + 0)
   0003 D6 04         [ 7]   53 	sub	a, #0x04
   0005 C8            [11]   54 	ret	Z
   0006 18 00         [12]   55 	jr	00102$
   0008                      56 00102$:
                             57 ;engine/tile_chac_chac.c:21: rda = 1 + (rdt - CHAC_CHAC_DETECT_TILE);
   0008 21r00r00      [10]   58 	ld	hl,#_rda
   000B 3Ar00r00      [13]   59 	ld	a,(#_rdt + 0)
   000E C6 DA         [ 7]   60 	add	a, #0xDA
   0010 77            [ 7]   61 	ld	(hl),a
                             62 ;engine/tile_chac_chac.c:22: rdb = rda << 4;
   0011 3Ar00r00      [13]   63 	ld	a,(#_rda + 0)
   0014 07            [ 4]   64 	rlca
   0015 07            [ 4]   65 	rlca
   0016 07            [ 4]   66 	rlca
   0017 07            [ 4]   67 	rlca
   0018 E6 F0         [ 7]   68 	and	a,#0xF0
                             69 ;engine/tile_chac_chac.c:23: rdc = (rdb << 1) + rdb;
   001A 32r00r00      [13]   70 	ld	(#_rdb + 0),a
   001D 87            [ 4]   71 	add	a, a
   001E 21r00r00      [10]   72 	ld	hl,#_rdb
   0021 FD 21r00r00   [14]   73 	ld	iy,#_rdc
   0025 86            [ 7]   74 	add	a, (hl)
   0026 FD 77 00      [19]   75 	ld	0 (iy),a
                             76 ;engine/tile_chac_chac.c:25: chac_chacs_yx [max_chac_chacs] = rdm;
   0029 11r00r00      [10]   77 	ld	de,#_chac_chacs_yx+0
   002C 2Ar00r00      [16]   78 	ld	hl,(_max_chac_chacs)
   002F 26 00         [ 7]   79 	ld	h,#0x00
   0031 19            [11]   80 	add	hl,de
   0032 3Ar00r00      [13]   81 	ld	a,(#_rdm + 0)
   0035 77            [ 7]   82 	ld	(hl),a
                             83 ;engine/tile_chac_chac.c:26: chac_chacs_state [max_chac_chacs] = 0;
   0036 11r00r00      [10]   84 	ld	de,#_chac_chacs_state+0
   0039 2Ar00r00      [16]   85 	ld	hl,(_max_chac_chacs)
   003C 26 00         [ 7]   86 	ld	h,#0x00
   003E 19            [11]   87 	add	hl,de
   003F 36 00         [10]   88 	ld	(hl),#0x00
                             89 ;engine/tile_chac_chac.c:27: chac_chacs_idlewait [max_chac_chacs] = rdc;
   0041 11r00r00      [10]   90 	ld	de,#_chac_chacs_idlewait+0
   0044 2Ar00r00      [16]   91 	ld	hl,(_max_chac_chacs)
   0047 26 00         [ 7]   92 	ld	h,#0x00
   0049 19            [11]   93 	add	hl,de
   004A 3Ar00r00      [13]   94 	ld	a,(#_rdc + 0)
   004D 77            [ 7]   95 	ld	(hl),a
                             96 ;engine/tile_chac_chac.c:28: chac_chacs_ct [max_chac_chacs] = rdc;
   004E 11r00r00      [10]   97 	ld	de,#_chac_chacs_ct+0
   0051 2Ar00r00      [16]   98 	ld	hl,(_max_chac_chacs)
   0054 26 00         [ 7]   99 	ld	h,#0x00
   0056 19            [11]  100 	add	hl,de
   0057 3Ar00r00      [13]  101 	ld	a,(#_rdc + 0)
   005A 77            [ 7]  102 	ld	(hl),a
                            103 ;engine/tile_chac_chac.c:30: ++ max_chac_chacs;
   005B 21r00r00      [10]  104 	ld	hl, #_max_chac_chacs+0
   005E 34            [11]  105 	inc	(hl)
   005F C9            [10]  106 	ret
                            107 ;engine/tile_chac_chac.c:33: void chac_chacs_do (void) {
                            108 ;	---------------------------------
                            109 ; Function chac_chacs_do
                            110 ; ---------------------------------
   0060                     111 _chac_chacs_do::
   0060 DD E5         [15]  112 	push	ix
   0062 DD 21 00 00   [14]  113 	ld	ix,#0
   0066 DD 39         [15]  114 	add	ix,sp
   0068 F5            [11]  115 	push	af
                            116 ;engine/tile_chac_chac.c:34: gpit = max_chac_chacs; while (gpit --) {
   0069 3Ar00r00      [13]  117 	ld	a,(#_max_chac_chacs + 0)
   006C 32r00r00      [13]  118 	ld	(#_gpit + 0),a
   006F                     119 00106$:
   006F FD 21r00r00   [14]  120 	ld	iy,#_gpit
   0073 FD 56 00      [19]  121 	ld	d,0 (iy)
   0076 FD 21r00r00   [14]  122 	ld	iy,#_gpit
   007A FD 35 00      [23]  123 	dec	0 (iy)
   007D 7A            [ 4]  124 	ld	a,d
   007E B7            [ 4]  125 	or	a, a
   007F CAr18r01      [10]  126 	jp	Z,00108$
                            127 ;engine/tile_chac_chac.c:35: if (chac_chacs_ct [gpit]) -- chac_chacs_ct [gpit]; else {
   0082 3Ar00r00      [13]  128 	ld	a,(#_gpit + 0)
   0085 C6r00         [ 7]  129 	add	a, #<(_chac_chacs_ct)
   0087 DD 77 FE      [19]  130 	ld	-2 (ix),a
   008A 3E 00         [ 7]  131 	ld	a,#0x00
   008C CEs00         [ 7]  132 	adc	a, #>(_chac_chacs_ct)
   008E DD 77 FF      [19]  133 	ld	-1 (ix),a
   0091 E1            [10]  134 	pop	hl
   0092 E5            [11]  135 	push	hl
   0093 7E            [ 7]  136 	ld	a,(hl)
   0094 B7            [ 4]  137 	or	a, a
   0095 28 07         [12]  138 	jr	Z,00104$
   0097 C6 FF         [ 7]  139 	add	a,#0xFF
   0099 E1            [10]  140 	pop	hl
   009A E5            [11]  141 	push	hl
   009B 77            [ 7]  142 	ld	(hl),a
   009C 18 D1         [12]  143 	jr	00106$
   009E                     144 00104$:
                            145 ;engine/tile_chac_chac.c:36: ++ chac_chacs_state [gpit];
   009E 3Er00         [ 7]  146 	ld	a,#<(_chac_chacs_state)
   00A0 21r00r00      [10]  147 	ld	hl,#_gpit
   00A3 86            [ 7]  148 	add	a, (hl)
   00A4 5F            [ 4]  149 	ld	e,a
   00A5 3Es00         [ 7]  150 	ld	a,#>(_chac_chacs_state)
   00A7 CE 00         [ 7]  151 	adc	a, #0x00
   00A9 57            [ 4]  152 	ld	d,a
   00AA 1A            [ 7]  153 	ld	a,(de)
   00AB 3C            [ 4]  154 	inc	a
   00AC 12            [ 7]  155 	ld	(de),a
                            156 ;engine/tile_chac_chac.c:37: if (chac_chacs_state [gpit] == 6) chac_chacs_state [gpit] = 0;
   00AD 3Er00         [ 7]  157 	ld	a,#<(_chac_chacs_state)
   00AF 21r00r00      [10]  158 	ld	hl,#_gpit
   00B2 86            [ 7]  159 	add	a, (hl)
   00B3 5F            [ 4]  160 	ld	e,a
   00B4 3Es00         [ 7]  161 	ld	a,#>(_chac_chacs_state)
   00B6 CE 00         [ 7]  162 	adc	a, #0x00
   00B8 57            [ 4]  163 	ld	d,a
   00B9 1A            [ 7]  164 	ld	a,(de)
   00BA D6 06         [ 7]  165 	sub	a, #0x06
   00BC 20 02         [12]  166 	jr	NZ,00102$
   00BE AF            [ 4]  167 	xor	a, a
   00BF 12            [ 7]  168 	ld	(de),a
   00C0                     169 00102$:
                            170 ;engine/tile_chac_chac.c:38: chac_chacs_ct [gpit] = chac_chacs_state [gpit] ? 
   00C0 3Er00         [ 7]  171 	ld	a,#<(_chac_chacs_ct)
   00C2 21r00r00      [10]  172 	ld	hl,#_gpit
   00C5 86            [ 7]  173 	add	a, (hl)
   00C6 4F            [ 4]  174 	ld	c,a
   00C7 3Es00         [ 7]  175 	ld	a,#>(_chac_chacs_ct)
   00C9 CE 00         [ 7]  176 	adc	a, #0x00
   00CB 47            [ 4]  177 	ld	b,a
   00CC FD 21r00r00   [14]  178 	ld	iy,#_chac_chacs_state
   00D0 ED 5Br00r00   [20]  179 	ld	de,(_gpit)
   00D4 16 00         [ 7]  180 	ld	d,#0x00
   00D6 FD 19         [15]  181 	add	iy, de
   00D8 FD 5E 00      [19]  182 	ld	e, 0 (iy)
   00DB 7B            [ 4]  183 	ld	a,e
   00DC B7            [ 4]  184 	or	a, a
   00DD 28 09         [12]  185 	jr	Z,00115$
                            186 ;engine/tile_chac_chac.c:39: (chac_chacs_times [chac_chacs_state [gpit]]) :
   00DF 21r00r00      [10]  187 	ld	hl,#_chac_chacs_times
   00E2 16 00         [ 7]  188 	ld	d,#0x00
   00E4 19            [11]  189 	add	hl, de
   00E5 7E            [ 7]  190 	ld	a,(hl)
   00E6 18 0F         [12]  191 	jr	00116$
   00E8                     192 00115$:
                            193 ;engine/tile_chac_chac.c:40: chac_chacs_idlewait [gpit];
   00E8 FD 21r00r00   [14]  194 	ld	iy,#_chac_chacs_idlewait
   00EC ED 5Br00r00   [20]  195 	ld	de,(_gpit)
   00F0 16 00         [ 7]  196 	ld	d,#0x00
   00F2 FD 19         [15]  197 	add	iy, de
   00F4 FD 7E 00      [19]  198 	ld	a, 0 (iy)
   00F7                     199 00116$:
   00F7 02            [ 7]  200 	ld	(bc),a
                            201 ;engine/tile_chac_chac.c:43: chac_chacs_queue [chac_chacs_queue_write] = gpit;
   00F8 3Er00         [ 7]  202 	ld	a,#<(_chac_chacs_queue)
   00FA 21r00r00      [10]  203 	ld	hl,#_chac_chacs_queue_write
   00FD 86            [ 7]  204 	add	a, (hl)
   00FE 5F            [ 4]  205 	ld	e,a
   00FF 3Es00         [ 7]  206 	ld	a,#>(_chac_chacs_queue)
   0101 CE 00         [ 7]  207 	adc	a, #0x00
   0103 57            [ 4]  208 	ld	d,a
   0104 3Ar00r00      [13]  209 	ld	a,(#_gpit + 0)
   0107 12            [ 7]  210 	ld	(de),a
                            211 ;engine/tile_chac_chac.c:44: chac_chacs_queue_write = (chac_chacs_queue_write + 1) & (MAX_CHAC_CHACKS_QUEUED-1);
   0108 3Ar00r00      [13]  212 	ld	a,(#_chac_chacs_queue_write + 0)
   010B 3C            [ 4]  213 	inc	a
   010C E6 0F         [ 7]  214 	and	a, #0x0F
   010E FD 21r00r00   [14]  215 	ld	iy,#_chac_chacs_queue_write
   0112 FD 77 00      [19]  216 	ld	0 (iy),a
   0115 C3r6Fr00      [10]  217 	jp	00106$
   0118                     218 00108$:
                            219 ;engine/tile_chac_chac.c:48: if (chac_chacs_queue_write != chac_chacs_queue_read) {
   0118 3Ar00r00      [13]  220 	ld	a,(#_chac_chacs_queue_write + 0)
   011B FD 21r00r00   [14]  221 	ld	iy,#_chac_chacs_queue_read
   011F FD 96 00      [19]  222 	sub	a, 0 (iy)
   0122 CArCBr01      [10]  223 	jp	Z,00113$
                            224 ;engine/tile_chac_chac.c:49: gpit = chac_chacs_queue [chac_chacs_queue_read];
   0125 3Er00         [ 7]  225 	ld	a,#<(_chac_chacs_queue)
   0127 21r00r00      [10]  226 	ld	hl,#_chac_chacs_queue_read
   012A 86            [ 7]  227 	add	a, (hl)
   012B 5F            [ 4]  228 	ld	e,a
   012C 3Es00         [ 7]  229 	ld	a,#>(_chac_chacs_queue)
   012E CE 00         [ 7]  230 	adc	a, #0x00
   0130 57            [ 4]  231 	ld	d,a
   0131 1A            [ 7]  232 	ld	a,(de)
   0132 32r00r00      [13]  233 	ld	(#_gpit + 0),a
                            234 ;engine/tile_chac_chac.c:50: chac_chacs_queue_read = (chac_chacs_queue_read + 1) & (MAX_CHAC_CHACKS_QUEUED-1);
   0135 3Ar00r00      [13]  235 	ld	a,(#_chac_chacs_queue_read + 0)
   0138 3C            [ 4]  236 	inc	a
   0139 E6 0F         [ 7]  237 	and	a, #0x0F
   013B 32r00r00      [13]  238 	ld	(#_chac_chacs_queue_read + 0),a
                            239 ;engine/tile_chac_chac.c:51: rdm = chac_chacs_state [gpit];
   013E 3Er00         [ 7]  240 	ld	a,#<(_chac_chacs_state)
   0140 21r00r00      [10]  241 	ld	hl,#_gpit
   0143 86            [ 7]  242 	add	a, (hl)
   0144 5F            [ 4]  243 	ld	e,a
   0145 3Es00         [ 7]  244 	ld	a,#>(_chac_chacs_state)
   0147 CE 00         [ 7]  245 	adc	a, #0x00
   0149 57            [ 4]  246 	ld	d,a
   014A 1A            [ 7]  247 	ld	a,(de)
                            248 ;engine/tile_chac_chac.c:52: if (rdm == 3) { 
   014B 32r00r00      [13]  249 	ld	(#_rdm + 0),a
   014E D6 03         [ 7]  250 	sub	a, #0x03
   0150 20 05         [12]  251 	jr	NZ,00110$
                            252 ;engine/tile_chac_chac.c:53: shaker_ct = 8; 
   0152 21r00r00      [10]  253 	ld	hl,#_shaker_ct + 0
   0155 36 08         [10]  254 	ld	(hl), #0x08
   0157                     255 00110$:
                            256 ;engine/tile_chac_chac.c:56: rdx = chac_chacs_yx [gpit]; rdy = rdx >> 4; rdx &= 0xf;
   0157 11r00r00      [10]  257 	ld	de,#_chac_chacs_yx+0
   015A 2Ar00r00      [16]  258 	ld	hl,(_gpit)
   015D 26 00         [ 7]  259 	ld	h,#0x00
   015F 19            [11]  260 	add	hl,de
   0160 7E            [ 7]  261 	ld	a,(hl)
   0161 32r00r00      [13]  262 	ld	(#_rdx + 0),a
   0164 07            [ 4]  263 	rlca
   0165 07            [ 4]  264 	rlca
   0166 07            [ 4]  265 	rlca
   0167 07            [ 4]  266 	rlca
   0168 E6 0F         [ 7]  267 	and	a,#0x0F
   016A 32r00r00      [13]  268 	ld	(#_rdy + 0),a
   016D 3Ar00r00      [13]  269 	ld	a,(#_rdx + 0)
   0170 E6 0F         [ 7]  270 	and	a, #0x0F
                            271 ;engine/tile_chac_chac.c:57: _x = rdx; _y = rdy    ; _t = chac_chacs_t1 [rdm]; map_set ();
   0172 32r00r00      [13]  272 	ld	(#_rdx + 0),a
   0175 32r00r00      [13]  273 	ld	(#__x + 0),a
   0178 3Ar00r00      [13]  274 	ld	a,(#_rdy + 0)
   017B 32r00r00      [13]  275 	ld	(#__y + 0),a
   017E 11r00r00      [10]  276 	ld	de,#_chac_chacs_t1+0
   0181 2Ar00r00      [16]  277 	ld	hl,(_rdm)
   0184 26 00         [ 7]  278 	ld	h,#0x00
   0186 19            [11]  279 	add	hl,de
   0187 7E            [ 7]  280 	ld	a,(hl)
   0188 32r00r00      [13]  281 	ld	(#__t + 0),a
   018B CDr00r00      [17]  282 	call	_map_set
                            283 ;engine/tile_chac_chac.c:58: _x = rdx; _y = rdy + 1; _t = chac_chacs_t2 [rdm]; map_set ();
   018E 3Ar00r00      [13]  284 	ld	a,(#_rdx + 0)
   0191 32r00r00      [13]  285 	ld	(#__x + 0),a
   0194 21r00r00      [10]  286 	ld	hl,#__y
   0197 3Ar00r00      [13]  287 	ld	a,(#_rdy + 0)
   019A 3C            [ 4]  288 	inc	a
   019B 77            [ 7]  289 	ld	(hl),a
   019C 11r00r00      [10]  290 	ld	de,#_chac_chacs_t2+0
   019F 2Ar00r00      [16]  291 	ld	hl,(_rdm)
   01A2 26 00         [ 7]  292 	ld	h,#0x00
   01A4 19            [11]  293 	add	hl,de
   01A5 7E            [ 7]  294 	ld	a,(hl)
   01A6 32r00r00      [13]  295 	ld	(#__t + 0),a
   01A9 CDr00r00      [17]  296 	call	_map_set
                            297 ;engine/tile_chac_chac.c:59: _x = rdx; _y = rdy + 2; _t = chac_chacs_t3 [rdm]; map_set ();
   01AC 3Ar00r00      [13]  298 	ld	a,(#_rdx + 0)
   01AF 32r00r00      [13]  299 	ld	(#__x + 0),a
   01B2 21r00r00      [10]  300 	ld	hl,#__y
   01B5 3Ar00r00      [13]  301 	ld	a,(#_rdy + 0)
   01B8 C6 02         [ 7]  302 	add	a, #0x02
   01BA 77            [ 7]  303 	ld	(hl),a
   01BB 11r00r00      [10]  304 	ld	de,#_chac_chacs_t3+0
   01BE 2Ar00r00      [16]  305 	ld	hl,(_rdm)
   01C1 26 00         [ 7]  306 	ld	h,#0x00
   01C3 19            [11]  307 	add	hl,de
   01C4 7E            [ 7]  308 	ld	a,(hl)
   01C5 32r00r00      [13]  309 	ld	(#__t + 0),a
   01C8 CDr00r00      [17]  310 	call	_map_set
   01CB                     311 00113$:
   01CB DD F9         [10]  312 	ld	sp, ix
   01CD DD E1         [14]  313 	pop	ix
   01CF C9            [10]  314 	ret
                            315 	.area _CODE
                            316 	.area _INITIALIZER
                            317 	.area _CABS (ABS)
